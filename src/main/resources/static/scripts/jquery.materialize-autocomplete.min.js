!function(e,t){"object"==typeof module&&module.exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery)}(this,function(s){var e=function(o){var t,e=new RegExp("<%=([\\s\\S]+?)%>|<%([\\s\\S]+?)%>|$","g"),n={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},a=/\\|'|\r|\n|\u2028|\u2029/g,l=function(e){return"\\"+n[e]},d=0,r="__p+='";o.replace(e,function(e,t,n,i){return r+=o.slice(d,i).replace(a,l),d=i+e.length,t?r+="'+\n((__t=("+t+"))==null?'':__t)+\n'":n&&(r+="';\n"+n+"\n__p+='"),e}),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(r="with(obj||{}){\n"+(r+="';\n")+"}\n")+"return __p;\n";try{t=new Function("obj",r)}catch(e){throw e.source=r,e}var i=function(e){return t.call(this,e)};return i.source="function(obj){\n"+r+"}",i},o=function(e,t){this.options=s.extend(!0,{},o.defaults,t),this.$el=s(e),this.$wrapper=this.$el.parent(),this.compiled={},this.$dropdown=null,this.$appender=null,this.$hidden=null,this.resultCache={},this.value="",this.initialize()};o.defaults={cacheable:!0,limit:10,multiple:{enable:!1,maxSize:4,onExist:function(e){Materialize.toast("Tag: "+e.text+"("+e.id+") is already added!",2e3)},onExceed:function(e,t){Materialize.toast("Can't add over "+e+" tags!",2e3)},onAppend:function(e){this.$el.removeClass("active"),this.$el.click()},onRemove:function(e){this.$el.removeClass("active"),this.$el.click()}},hidden:{enable:!0,el:"",inputName:"",required:!1},appender:{el:"",tagName:"ul",className:"ac-appender",tagTemplate:'<div class="chip" data-id="<%= item.id %>" data-text="<%= item.text %>"><%= item.text %>(<%= item.id %>)<i class="material-icons close">close</i></div>'},dropdown:{el:"",tagName:"ul",className:"ac-dropdown",itemTemplate:'<li class="ac-item" data-id="<%= item.id %>" data-text="<%= item.text %>"><a href="#"><%= item.text %></a></li>',noItem:""},getData:function(e,t){t(e,[])},onSelect:function(){},ignoreCase:!0,throttling:!0,debounce:200,enterOnSpace:!1,allowNotSelectedItems:!1},o.prototype={constructor:o,initialize:function(){var n,p=this;function i(e,t){var n,i,o=(i="",(n=t).length?(n.forEach(function(e,t){if(t>=p.options.limit)return!1;i+=p.compiled.item({item:e})}),i):p.options.dropdown.noItem),a=p.$el.val();if(p.options.ignoreCase&&(a=a.toUpperCase()),p.options.cacheable&&!p.resultCache.hasOwnProperty(e)&&(p.resultCache[e]=t),e!==a)return!1;o?(p.$dropdown.html(o),p.$dropdown.show()):p.$dropdown.hide()}p.value=p.options.multiple.enable?[]:"",p.compiled.tag=e(p.options.appender.tagTemplate),p.compiled.item=e(p.options.dropdown.itemTemplate),p.render(),p.$el.on("input",function(e){var t=s(this).val();return t?(p.options.ignoreCase&&(t=t.toUpperCase()),p.resultCache.hasOwnProperty(t)&&p.resultCache[t]?(i(t,p.resultCache[t]),!0):p.options.throttling?(clearTimeout(n),n=setTimeout(function(){p.options.getData(t,i)},p.options.debounce),!0):void p.options.getData(t,i)):(p.$dropdown.hide(),!1)}),p.$el.on("keydown",function(e){var t,n,i,o,a=s(this),l=e.keyCode;if("8"==l&&!a.val()){if(!p.options.multiple.enable)return!0;if(!p.value.length)return!0;var d=p.value[p.value.length-1];return p.remove(d),!1}if("38"==l||"40"==l){if(!(t=p.$dropdown.find("[data-id]")).length)return!1;if((n=t.filter(".ac-hover")).length){var r=n.index();t.removeClass("ac-hover"),t.eq("40"==l?(r+1)%t.length:r-1).addClass("ac-hover")}else t.removeClass("ac-hover"),t.eq("40"==l?0:-1).addClass("ac-hover");return!1}if("13"==l||p.options.enterOnSpace&&"32"==l)return!(t=p.$dropdown.find("[data-id]")).length&&p.options.allowNotSelectedItems?o=i=e.target.value:t.length&&((n=t.filter(".ac-hover")).length?(i=n.data("id"),o=n.data("text")):p.options.allowNotSelectedItems&&(o=i=e.target.value)),i&&p.setValue({id:i,text:o}),!1}),p.$dropdown.on("click","[data-id]",function(e){var t=s(this),n={id:t.data("id"),text:t.data("text")};p.setValue(n)}),p.$appender.on("click","[data-id] .close",function(e){var t=s(this).closest("[data-id]"),n={id:t.data("id"),text:t.data("text")};p.remove(n)})},render:function(){var e=this;e.options.dropdown.el?e.$dropdown=s(e.options.dropdown.el):(e.$dropdown=s(document.createElement(e.options.dropdown.tagName)),e.$dropdown.insertAfter(e.$el)),e.$dropdown.addClass(e.options.dropdown.className),e.options.appender.el?e.$appender=s(e.options.appender.el):(e.$appender=s(document.createElement(e.options.appender.tagName)),e.$appender.insertBefore(e.$el)),e.options.hidden.enable&&(e.options.hidden.el?e.$hidden=s(e.options.hidden.el):(e.$hidden=s('<input type="hidden" class="validate" />'),e.$wrapper.append(e.$hidden)),e.options.hidden.inputName&&e.$hidden.attr("name",e.options.hidden.inputName),e.options.hidden.required&&e.$hidden.attr("required","required")),e.$appender.addClass(e.options.appender.className)},setValue:function(e){this.options.multiple.enable?this.append(e):this.select(e)},append:function(t){var e=this,n=e.compiled.tag({item:t});if(e.value.some(function(e){return e.id===t.id}))return"function"==typeof e.options.multiple.onExist&&e.options.multiple.onExist.call(this,t),!1;if(e.value.length>=e.options.multiple.maxSize)return"function"==typeof e.options.multiple.onExceed&&e.options.multiple.onExceed.call(this,e.options.multiple.maxSize,t),!1;e.value.push(t),e.$appender.append(n);var i=e.value.map(function(e){return e.id}).join(",");e.options.hidden.enable&&e.$hidden.val(i),e.$el.val(""),e.$el.data("value",i),e.$dropdown.html("").hide(),"function"==typeof e.options.multiple.onAppend&&e.options.multiple.onAppend.call(e,t)},remove:function(t){var e=this;e.$appender.find('[data-id="'+t.id+'"]').remove(),e.value=e.value.filter(function(e){return e.id!==t.id});var n=e.value.map(function(e){return e.id}).join(",");e.options.hidden.enable&&(e.$hidden.val(n),e.$el.data("value",n)),e.$dropdown.html("").hide(),"function"==typeof e.options.multiple.onRemove&&e.options.multiple.onRemove.call(e,t)},clear:function(){if(this.options.multiple.enable)for(;0<this.value.length;)this.remove(this.value[0]);else this.select({id:"",text:""});this.$el.val("")},select:function(e){var t=this;t.value=e.text,t.$el.val(e.text),t.$el.data("value",e.id),t.$dropdown.html("").hide(),t.options.hidden.enable&&t.$hidden.val(e.id),"function"==typeof t.options.onSelect&&t.options.onSelect.call(t,e)}},s.fn.materialize_autocomplete=function(e){var t=s(this).eq(0),n=t.data("autocomplete");if(n&&arguments.length)return n;var i=new o(this,e);return t.data("autocomplete",i),t.dropdown(),i}});